## 왜 index를 key로 사용하면 안 되는지 설명해주세요.

[블로그 정리](https://yoolllog.tistory.com/45)

리액트에서 key는 각 컴포넌트를 고유하게 식별할 수 있는 값이어야 합니다. index를 key로 사용하면, 리스트 항목의 순서가 바뀌거나 추가/삭제가 발생할 때 리액트가 기존 컴포넌트를 재사용하는 데 문제가 발생할 수 있습니다. 특히, 리스트가 동적으로 변경될 때는 key로 index를 사용하면 상태가 올바르게 유지되지 않아 예기치 않은 렌더링 문제가 발생할 수 있습니다.

---

### React에서 배열 index를 key로 쓰면 생기는 문제

- 컴포넌트 식별자 불안정 : React는 같은 key면 “같은 컴포넌트”로 간주해 이전 state·DOM을 재사용한다.

  - 요소가 삽입·삭제·정렬되면 뒤의 index가 전부 밀려 key 값이 줄줄이 바뀜.

  - 결과적으로 오래된 state·DOM이 다른 데이터에 붙어버려 입력 필드가 엉뚱한 값을 갖거나 체크박스가 잘못 체크되는 식의 버그가 발생한다.

- 불필요한 재렌더·DOM 조작 : index가 바뀌면 React는 “새로운 key”로 인식해 해당 행 이하를 모두 unmount → mount 한다.

  - 화면에는 변동이 없어도 DOM 노드가 대량 교체되어 스크롤 위치가 튀거나 애니메이션이 끊긴다.

  - reconciliation 최적화가 사라져 성능 손실.

- 디버깅 난이도 상승 : 버그가 state 옮겨 붙음-성격이라 재현이 어려워 디버깅 비용이 크게 늘어난다.

### 언제 index를 써도 괜찮을까?

- 리스트가 절대 순서 변경·삽입·삭제되지 않을 때
  (정적 메뉴, 별도의 고유 ID가 전혀 없는 짧은 목록 등)

- 자식 컴포넌트가 자체 state·ref·애니메이션을 갖지 않을 때
  → 여전히 고유 ID가 있으면 그것을 쓰는 편이 안전하다.
