# 토픽: Webpack

## Q. 개발 환경과 프로덕션 환경의 웹팩 설정 차이는?

### 주요 키워드

- **개발 환경 (Development Environment)**: 개발자가 코드를 작성하고 테스트하는 환경
- **프로덕션 환경 (Production Environment)**: 실제 사용자에게 서비스되는 운영 환경
- **소스맵 (Source Map)**: 압축된 코드를 원본 코드와 연결해주는 파일로 디버깅을 도움
- **핫 모듈 교체 (Hot Module Replacement, HMR)**: 페이지 새로고침 없이 모듈을 실시간으로 교체하는 기능
- **개발 서버 (Dev Server)**: 개발 중 파일 변경을 감지하고 자동으로 브라우저를 새로고침하는 서버
- **webpack-merge**: 여러 웹팩 설정 파일을 병합하는 유틸리티
- **TerserPlugin**: 프로덕션에서 JavaScript 코드를 압축하고 최적화하는 플러그인
- **DefinePlugin**: 컴파일 타임에 전역 상수를 정의하는 플러그인
- **캐시 버스팅 (Cache Busting)**: 파일명에 해시를 추가하여 브라우저 캐시 문제를 해결하는 기법

### Script

개발 환경과 프로덕션 빌드의 목표는 크게 다릅니다. 개발에서는 강력한 소스 매핑과 라이브 리로딩 또는 핫 모듈 교체가 가능한 로컬호스트 서버가 필요하고, 프로덕션에서는 압축된 번들, 가벼운 소스맵, 로드 시간 향상을 위한 최적화된 에셋에 초점을 맞춥니다.

**개발 환경에서는 개발 효율성과 디버깅 편의성을 최우선으로 합니다.** 모드를 'development'로 설정하고 강력한 소스 매핑을 위해 'inline-source-map' 옵션을 사용합니다. 이는 오류가 발생했을 때 정확한 원본 파일과 라인 번호를 추적할 수 있게 해줍니다. 또한 webpack-dev-server를 통해 파일 변경 감지와 자동 브라우저 새로고침 기능을 제공하며, 핫 모듈 교체를 활성화하여 페이지 전체를 새로고침하지 않고도 변경사항을 즉시 반영할 수 있습니다.

**프로덕션 환경에서는 성능과 최적화에 모든 것을 집중합니다.** 모드를 'production'으로 설정하면 TerserPlugin이 자동으로 로드되어 코드를 압축하고 최적화합니다. 또한 DefinePlugin을 통해 process.env.NODE_ENV가 자동으로 'production'으로 설정되어 React와 같은 라이브러리에서 프로덕션 최적화가 활성화됩니다. 소스맵은 보안과 성능을 위해 'source-map' 옵션을 사용하여 별도 파일로 분리하거나 완전히 제거합니다.

**설정 관리의 모범 사례는 환경별 분리입니다.** webpack-merge 유틸리티를 사용하여 공통 설정을 유지하면서 환경별 특정 설정을 분리하는 것을 권장합니다. webpack.common.js에서 엔트리 포인트와 출력 설정 같은 공통 요소를 정의하고, webpack.dev.js에서는 개발 서버와 소스맵 설정을, webpack.prod.js에서는 압축과 최적화 설정을 각각 관리합니다.

**빌드 성능 측면에서도 접근 방식이 다릅니다.** 개발 환경에서는 빠른 빌드 속도를 위해 대부분의 최적화를 비활성화하고 인라인 소스맵을 사용하여 즉각적인 피드백을 받습니다. 반면 프로덕션에서는 빌드 시간보다는 최종 번들의 크기와 성능을 우선시하여 모든 최적화 옵션을 활성화하고 트리 셰이킹과 코드 스플리팅을 적극 활용합니다.

### 추가 학습내용

#### **고급 설정 관리 전략**

1. **다중 환경 설정**: staging, testing 등 추가 환경별 웹팩 설정 관리
2. **환경 변수 활용**: dotenv와 DefinePlugin을 통한 동적 설정 주입
3. **조건부 설정**: 환경에 따른 플러그인과 로더의 조건부 로드
4. **설정 검증**: webpack-validator를 통한 설정 파일 유효성 검사

#### **개발 환경 최적화 심화**

5. **HMR 고급 활용**: React Fast Refresh, Vue HMR 등 프레임워크별 최적화
6. **개발 서버 커스터마이징**: 프록시 설정, HTTPS, 커스텀 미들웨어 구성
7. **소스맵 성능 튜닝**: 다양한 소스맵 옵션의 빌드 시간과 디버깅 품질 비교
8. **개발 도구 통합**: VS Code, Chrome DevTools와 웹팩 연동 최적화

#### **프로덕션 최적화 고급 기법**

9. **번들 분석 자동화**: CI/CD 파이프라인에서 번들 크기 모니터링
10. **프로그레시브 웹 앱**: Service Worker, 매니페스트 파일 자동 생성
11. **성능 예산**: 번들 크기 임계값 설정과 자동 알림 시스템
12. **CDN 통합**: 에셋을 CDN으로 자동 업로드하는 플러그인 구성

#### **모니터링 및 최적화**

13. **웹 바이탈 측정**: Core Web Vitals와 웹팩 설정의 상관관계 분석
14. **실시간 성능 모니터링**: Lighthouse CI를 통한 지속적 성능 측정
15. **A/B 테스팅**: 다양한 최적화 전략의 실제 사용자 영향 측정

---

### 정리

**개발 환경 설정**

- `mode: 'development'`로 개발 최적화 활성화
- `devtool: 'inline-source-map'`로 강력한 디버깅 지원
- `devServer` 설정으로 라이브 리로딩과 HMR 활성화
- 빌드 속도 우선, 최적화 최소화

**프로덕션 환경 설정**

- `mode: 'production'`으로 자동 압축과 최적화
- `devtool: 'source-map'`으로 별도 소스맵 파일 생성
- TerserPlugin 자동 활성화로 코드 최소화
- DefinePlugin으로 환경 변수 최적화

**설정 파일 구조**

- `webpack.common.js`: 공통 설정 (엔트리, 아웃풋, 플러그인)
- `webpack.dev.js`: 개발 전용 설정 (dev server, HMR)
- `webpack.prod.js`: 프로덕션 전용 설정 (최적화, 압축)
- `webpack-merge`로 설정 병합

**스크립트 분리**

- `npm start`: 개발 서버 실행 (`webpack.dev.js` 사용)
- `npm run build`: 프로덕션 빌드 (`webpack.prod.js` 사용)
- 환경별 명령어로 적절한 설정 파일 자동 선택
