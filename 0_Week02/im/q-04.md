# 토픽: Webpack

## Q. 트리 쉐이킹(Tree Shaking)이 동작하려면 어떤 조건이 필요한가요?

## 주요 키워드

- **트리 쉐이킹 (Tree Shaking)**: 웹팩(Webpack)과 같은 번들러가 사용하지 않는 코드를 제거하여 최종 번들(bundle) 크기를 최적화하는 기법
- **데드 코드 제거 (Dead Code Elimination)**: 애플리케이션에서 실제로 사용되지 않는 코드를 식별하고 제거하는 과정
- **ES 모듈 (ES Modules, ESM)**: 자바스크립트 모듈 시스템의 표준으로, `import`와 `export` 구문을 사용
- **정적 분석 (Static Analysis)**: 코

## Script

트리 쉐이킹은 웹팩과 같은 모듈 번들러가 애플리케이션의 최종 번들 크기를 최적화하기 위해 사용하지 않는 코드를 제거하는 기법입니다. 이 기술이 제대로 동작하기 위해서는 몇 가지 중요한 조건이 필요합니다.

첫째, **ES 모듈(ES Modules) 사용**이 필수적입니다. 트리 쉐이킹은 `import`와 `export`와 같은 ES 모듈 구문을 기반으로 정적 분석을 수행합니다. 즉, 어떤 모듈이 실제로 사용되고 있는지 정확하게 파악하기 위해서는 정적으로 분석 가능한 ES 모듈 시스템이 필요하며, CommonJS와 같은 다른 모듈 시스템에서는 일반적으로 트리 쉐이킹이 제대로 작동하지 않습니다.

둘째, **부수 효과(Side Effects)가 없는 모듈**이 중요합니다. 트리 쉐이킹은 코드를 제거하는 과정에서 해당 코드가 애플리케이션의 동작에 영향을 미치는지(즉, 부수 효과가 있는지)를 판단해야 합니다. 만약 모듈에 부수 효과가 있다면, 해당 코드가 직접적으로 `import`되지 않았더라도 제거되면 안 될 수 있습니다. 웹팩에서는 `package.json` 파일에 `sideEffects: false`를 설정하여 해당 모듈이 부수 효과가 없음을 명시하거나, 특정 파일에 한해서 부수 효과가 없음을 설정할 수 있습니다.

셋째, **프로덕션 모드(Production Mode) 활성화**입니다. 웹팩의 프로덕션 모드는 기본적으로 트리 쉐이킹을 포함한 다양한 최적화 옵션을 활성화합니다. 개발 모드에서는 디버깅을 위해 사용하지 않는 코드라도 번들에 포함될 수 있지만, 프로덕션 빌드에서는 번들 크기를 최소화하기 위해 트리 쉐이킹이 적극적으로 적용됩니다.

넷째, **바벨(Babel) 설정 확인**입니다. 만약 바벨을 사용한다면, ES 모듈 구문이 CommonJS 등으로 트랜스파일되지 않도록 설정해야 합니다. 바벨의 `@babel/preset-env` 설정에서 `modules: false` 옵션을 사용하여 바벨이 `import`와 `export` 구문을 그대로 유지하도록 해야 트리 쉐이킹이 정상적으로 이루어질 수 있습니다.

이러한 조건들이 충족될 때 웹팩은 사용되지 않는 코드를 효과적으로 제거하여 최종 번들 크기를 줄이고 애플리케이션의 성능을 향상시킬 수 있습니다.

## 더 공부할 내용

- `package.json`의 `sideEffects` 필드와 그 활용법
- 웹팩의 `optimization.usedExports` 옵션과 역할
- CommonJS 모듈과 ES 모듈의 트리 쉐이킹 차이점
- 바벨(Babel)의 `modules: false` 옵션이 트리 쉐이킹에 미치는 영향
- 번들 분석 도구(예: Webpack Bundle Analyzer)를 활용한 트리 쉐이킹 효과 확인 방법

---

### 정리

**필요 조건들**

- ES6 모듈 시스템 사용 (import/export)
- `package.json`에서 `"sideEffects": false` 설정
- 프로덕션 모드에서 실행
- `optimization.usedExports: true` 설정

**주의사항**

- CommonJS 모듈은 트리 쉐이킹 불가
- CSS import나 polyfill 같은 사이드 이펙트가 있는 파일은 별도 설정 필요
